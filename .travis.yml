version: ~> 1.0

os: linux

services:
  - docker

env:
  - PACKAGE_VERSION="$(date "+%Y-%m-%d")"

language: shell

script:
  - echo "${PACKAGE_VERSION}"
  - docker build -t "heapy/bsuir-diploma-latex:${PACKAGE_VERSION}-${TRAVIS_BUILD_NUMBER}" -t latest ./

deploy:
  provider: script
  script: bash devops/deploy.sh
  on:
    branch: master
